---
title: "blogpost7"
author: ""
date: "2024-04-29"
date-modified: "2024-04-29"
draft: FALSE
---

Our goal is to understand the labor conditions and work opportunities available to foreign workers in the United States. This inquiry is particularly relevant to our group as we are international job seekers aiming to navigate the complexities of the U.S. labor market. We seek to analyze factors such as visa regulations, industry-specific opportunities, wage standards, and workplace rights that significantly impact foreign workers.

By gaining a comprehensive understanding of these aspects, we hope to better prepare ourselves for successful employment in the U.S. and contribute positively to the workforce.


```{r}
library(dplyr)
library(tsibble)
library(tidyr)
library(ggplot2)
library(forecast)
library(zoo)
```

Load the combined datasets for yars 2019-2023
```{r}
combined_19_23 <- read.csv("dataset/combined_perm_19_23.csv")
```

We can look at correlation between education level and wage:
```{r}
combined_19_23_accepted <- combined_19_23 |>
  filter(CASE_STATUS %in% c("Certified", "Certified-Expired"))

#scatter plot: x = time, y = wage, color = education level
ggplot(combined_19_23_accepted, aes(x = yearmonth(year_month), y = log(WAGE_OFFER_FROM), color = FOREIGN_WORKER_EDUCATION)) +
  geom_point(alpha = 0.5) +
  labs(x = "Year Month", y = "Wage", color = "Education Level",
       title = "Scatter Plot of Wage vs Year Month")

```

This shows an interesting pattern of applicants with Education_level = other having a higher wage than applicants with a formally defined education level. Additionally, this shows that applicants with Masters earn slightly more than applicants with Bachelor's degrees.

Then, we can look at whether the education level of the applicant is correlated with the acceptance rate:

```{r}
education <- combined_19_23 %>%
  group_by(FOREIGN_WORKER_EDUCATION, year_month) %>%
  summarise(certified_count = sum(CASE_STATUS %in% c("Certified", "Certified-Expired")),
            total_count = n()) %>%
  mutate(non_certified_count = total_count - certified_count)
```

```{r}
ggplot(education, aes(y = total_count, x = yearmonth(year_month), color = FOREIGN_WORKER_EDUCATION)) +
  geom_line() +
  labs(x = "Decision Date", y = "Applied", title = "Applicants and Education Levels")
```


```{r}
ggplot(education, aes(y = certified_count, x = yearmonth(year_month), color = FOREIGN_WORKER_EDUCATION)) +
  geom_line() +
  labs(x = "Decision Date", y = "Accepted", title = "Accepted Applicants and Education Levels")
```

```{r}
ggplot(education, aes(y = certified_count/total_count, x = yearmonth(year_month))) +
  geom_line() +
  facet_wrap(~FOREIGN_WORKER_EDUCATION) +
  labs(x = "Decision Date", y = "Accepted", title = "Accptance Rate and Education Levels")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

From these figures, it can be concluded that applicants with higher degrees have better outcomes in the H1-B visa process. Additionally, while the acceptance rate across all education levels dropped during Covid, it is noted that the acceptance rate for applicants with a Bachelor's degree dropped lower than the acceptance rate for applicants with Doctorate's and Master's degrees.



What is your tentative thesis? Note that a thesis is not a hypothesis or a question. It should in some ways answer a question. (Eg. rather than, "What are the patterns of housing prices in Boston?", something like, "Housing prices in Boston are rising rapidly, especially near T stations and along the water.") The rest of the project should work to support that thesis. That doesn’t mean there won’t be any caveats or uncertainty, but you should try to accurately  provide details that provide evidence for your thesis.


How do you plan to polish your visualizations and tables? Think about titles, captions, annotations, highlights. Look into ggpubr for tools to improve your figures and look into some of the options for displaying tables using https://gallery.htmlwidgets.org/, for example the gt package we've used this semester.