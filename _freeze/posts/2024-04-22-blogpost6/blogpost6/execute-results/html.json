{
  "hash": "e19d6c6eb13e157f9ea845b175f21a58",
  "result": {
    "markdown": "---\ntitle: \"blogpost6\"\nauthor: \"\"\ndate: \"2024-04-22\"\ndate-modified: \"2024-04-22\"\ndraft: FALSE\n---\n\n\n## Import library\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressPackageStartupMessages(library(tidyverse))\nlibrary(tidyr)\nlibrary(viridis)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: viridisLite\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(ggfortify)\nlibrary(tidymodels)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRegistered S3 method overwritten by 'parsnip':\n  method          from     \n  autoplot.glmnet ggfortify\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ────────────────────────────────────── tidymodels 1.1.1 ──\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ broom        1.0.5     ✔ rsample      1.2.0\n✔ dials        1.2.0     ✔ tune         1.1.2\n✔ infer        1.0.5     ✔ workflows    1.1.3\n✔ modeldata    1.2.0     ✔ workflowsets 1.0.1\n✔ parsnip      1.1.1     ✔ yardstick    1.2.0\n✔ recipes      1.0.9     \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ scales::discard() masks purrr::discard()\n✖ dplyr::filter()   masks stats::filter()\n✖ recipes::fixed()  masks stringr::fixed()\n✖ dplyr::lag()      masks stats::lag()\n✖ yardstick::spec() masks readr::spec()\n✖ recipes::step()   masks stats::step()\n• Search for functions across packages at https://www.tidymodels.org/find/\n```\n:::\n\n```{.r .cell-code}\nlibrary(readxl)\nlibrary(readr)\nlibrary(lubridate)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfinal_df <- readRDS(\"dataset/final_merge.rds\")\nhead(final_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         CASE_NUMBER           CASE_STATUS RECEIVED_DATE DECISION_DATE\n1 I-200-19297-106681 Certified - Withdrawn    2019-10-24    2023-11-01\n2 I-200-19319-148860 Certified - Withdrawn    2019-11-15    2023-10-20\n3 I-200-19319-148860 Certified - Withdrawn    2019-11-15    2023-10-20\n4 I-200-19319-148860 Certified - Withdrawn    2019-11-15    2023-10-20\n5 I-200-19319-149308 Certified - Withdrawn    2019-11-15    2023-10-05\n6 I-200-19323-154281 Certified - Withdrawn    2019-11-19    2023-10-02\n  VISA_CLASS                JOB_TITLE FULL_TIME_POSITION BEGIN_DATE   END_DATE\n1       H-1B     Research Scientist I                  Y 2019-10-24 2022-10-23\n2       H-1B       Software Developer                  Y 2019-12-01 2022-11-30\n3       H-1B       Software Developer                  Y 2019-12-01 2022-11-30\n4       H-1B       Software Developer                  Y 2019-12-01 2022-11-30\n5       H-1B       Software Developer                  Y 2019-11-18 2022-11-17\n6       H-1B SENIOR SOFTWARE ENGINEER                  Y 2020-05-16 2023-05-15\n                       EMPLOYER_NAME EMPLOYER_STATE AGENT_REPRESENTING_EMPLOYER\n1    Georgia Institute of Technology             GA                          No\n2                     TRISHULLA, LLC             WI                         Yes\n3                     TRISHULLA, LLC             WI                         Yes\n4                     TRISHULLA, LLC             WI                         Yes\n5 INTERNATIONAL SOFTWARE SYSTEMS INC             MD                          No\n6            UBER TECHNOLOGIES, INC.             CA                         Yes\n  WORKSITE_WORKERS SECONDARY_ENTITY SECONDARY_ENTITY_BUSINESS_NAME\n1                1                N                           <NA>\n2                1                Y           Acuity Eyecare Group\n3                1                N                           <NA>\n4                1                N                           <NA>\n5                1                N                           <NA>\n6                1                N                           <NA>\n                     WORKSITE_ADDRESS1 WORKSITE_ADDRESS2 WORKSITE_CITY\n1                      313 Ferst Drive              <NA>       Atlanta\n2 4835 Lyndon B Johnson Fwy, Suite 850              <NA>        Dallas\n3       6629 UNIVERSITY AVE, SUITE 210              <NA>     MIDDLETON\n4       8383 Greenway Blvd., Suite 600              <NA>     Middleton\n5                 7337 Hanover Parkway           Suite A     Greenbelt\n6                   1455 MARKET STREET         4TH FLOOR SAN FRANCISCO\n  WORKSITE_COUNTY WORKSITE_STATE WORKSITE_POSTAL_CODE WAGE_RATE_OF_PAY_FROM\n1          FULTON        GEORGIA                30332                 52100\n2          DALLAS          TEXAS                75244                 77605\n3            DANE      WISCONSIN                53562                 77605\n4            DANE      WISCONSIN                53562                 77605\n5 PRINCE GEORGE'S       MARYLAND                20770                 76000\n6   SAN FRANCISCO     CALIFORNIA                94103                202442\n  WAGE_RATE_OF_PAY_TO WAGE_UNIT_OF_PAY PREVAILING_WAGE PW_UNIT_OF_PAY\n1                  NA             Year           46821           Year\n2               77700             Year           77605           Year\n3               77700             Year           65458           Year\n4               77700             Year           65458           Year\n5                  NA             Year           75712           Year\n6                  NA             Year          168958           Year\n  PW_TRACKING_NUMBER PW_WAGE_LEVEL          PW_OES_YEAR PW_OTHER_SOURCE\n1               <NA>             I 7/1/2019 - 6/30/2020            <NA>\n2               <NA>             I 7/1/2019 - 6/30/2020            <NA>\n3               <NA>             I 7/1/2019 - 6/30/2020            <NA>\n4               <NA>             I 7/1/2019 - 6/30/2020            <NA>\n5               <NA>             I 7/1/2019 - 6/30/2020            <NA>\n6               <NA>            IV 7/1/2019 - 6/30/2020            <NA>\n  PW_OTHER_YEAR PW_SURVEY_PUBLISHER PW_SURVEY_NAME APPX_A_NO_OF_EXEMPT_WORKERS\n1            NA                <NA>           <NA>                          NA\n2            NA                <NA>           <NA>                          NA\n3            NA                <NA>           <NA>                          NA\n4            NA                <NA>           <NA>                          NA\n5            NA                <NA>           <NA>                          NA\n6            NA                <NA>           <NA>                          NA\n  APPX_A_NAME_OF_INSTITUTION APPX_A_FIELD_OF_STUDY APPX_A_DATE_OF_DEGREE\n1                       <NA>                  <NA>                  <NA>\n2                       <NA>                  <NA>                  <NA>\n3                       <NA>                  <NA>                  <NA>\n4                       <NA>                  <NA>                  <NA>\n5                       <NA>                  <NA>                  <NA>\n6                       <NA>                  <NA>                  <NA>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nperm_df <- readRDS(\"dataset/perm_data.rds\")\nhead(perm_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 154\n  CASE_NUMBER   CASE_STATUS RECEIVED_DATE       DECISION_DATE       REFILE\n  <chr>         <chr>       <dttm>              <dttm>              <chr> \n1 A-23043-00641 Withdrawn   2023-02-12 00:00:00 2023-10-01 00:00:00 N     \n2 A-22256-20380 Certified   2022-09-22 00:00:00 2023-10-02 00:00:00 N     \n3 A-22271-30061 Certified   2022-10-24 00:00:00 2023-10-02 00:00:00 N     \n4 A-22272-30740 Certified   2022-10-24 00:00:00 2023-10-02 00:00:00 N     \n5 A-22185-82932 Certified   2022-07-26 00:00:00 2023-10-02 00:00:00 N     \n6 A-22189-85099 Certified   2022-11-16 00:00:00 2023-10-02 00:00:00 N     \n# ℹ 149 more variables: ORIG_FILE_DATE <dttm>,\n#   PREVIOUS_SWA_CASE_NUMBER_STATE <chr>, SCHD_A_SHEEPHERDER <chr>,\n#   EMPLOYER_NAME <chr>, EMPLOYER_ADDRESS_1 <chr>, EMPLOYER_ADDRESS_2 <chr>,\n#   EMPLOYER_CITY <chr>, EMPLOYER_STATE_PROVINCE <chr>, EMPLOYER_COUNTRY <chr>,\n#   EMPLOYER_POSTAL_CODE <dbl>, EMPLOYER_PHONE <chr>, EMPLOYER_PHONE_EXT <chr>,\n#   EMPLOYER_NUM_EMPLOYEES <dbl>, EMPLOYER_YEAR_COMMENCED_BUSINESS <dbl>,\n#   NAICS_CODE <dbl>, FW_OWNERSHIP_INTEREST <chr>, EMP_CONTACT_NAME <chr>, …\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfinal_perm_df <- select(perm_df, \"CASE_NUMBER\", \"CASE_STATUS\", \"RECEIVED_DATE\", \"DECISION_DATE\", \"EMPLOYER_NAME\",\n                        \"EMPLOYER_NUM_EMPLOYEES\", \"AGENT_ATTORNEY_FIRM_NAME\", \"PW_WAGE\", \"PW_SKILL_LEVEL\", \"WORKSITE_STATE\", \"JOB_TITLE\", \"PW_UNIT_OF_PAY\", \"WAGE_OFFER_FROM\", \"WAGE_OFFER_UNIT_OF_PAY\",\n                        , \"MINIMUM_EDUCATION\", \"REQUIRED_EXPERIENCE\", \"COUNTRY_OF_CITIZENSHIP\", \"CLASS_OF_ADMISSION\"\n                        )\n\nfinal_perm_df <- final_perm_df %>%\n  filter(PW_UNIT_OF_PAY == \"Year\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Split data into training and testing sets\nset.seed(123)\ndata_split <- initial_split(final_perm_df, prop = 0.8)\ntrain_data <- training(data_split)\ntest_data <- testing(data_split)\n\n# Create a recipe for preprocessing\nrecipe <- recipe(WAGE_OFFER_FROM ~ WORKSITE_STATE + PW_SKILL_LEVEL + MINIMUM_EDUCATION + REQUIRED_EXPERIENCE, data = train_data) %>%\n  step_dummy(all_nominal(), -all_outcomes()) %>%\n  step_zv(all_predictors())\n\n# Create a model specification\nmodel_spec <- linear_reg() %>% \n  set_engine(\"lm\") %>% \n  set_mode(\"regression\")\n\n# Bundle the recipe and model spec in a workflow\nworkflow <- workflow() %>%\n  add_recipe(recipe) %>%\n  add_model(model_spec)\n\n# Fit the model\nfitted_model <- fit(workflow, data = train_data)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: ! There are new levels in a factor: NA\n```\n:::\n\n```{.r .cell-code}\n# Evaluate the model\ntest_results <- fitted_model %>%\n  predict(new_data = test_data) %>%\n  bind_cols(test_data) %>%\n  metrics(truth = WAGE_OFFER_FROM, estimate = .pred)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: ! There are new levels in a factor: NA\n! There are new levels in a factor: NA\n```\n:::\n\n```{.r .cell-code}\n# Print results\nprint(test_results)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 3\n  .metric .estimator .estimate\n  <chr>   <chr>          <dbl>\n1 rmse    standard   35047.   \n2 rsq     standard       0.653\n3 mae     standard   23762.   \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Extract the model fit and view the summary\nmodel_fit <- extract_fit_parsnip(fitted_model)\nsummary(model_fit$fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nstats::lm(formula = ..y ~ ., data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-194470  -18383   -2269   13613 1535489 \n\nCoefficients:\n                                          Estimate Std. Error t value Pr(>|t|)\n(Intercept)                              34492.819   4966.579   6.945 3.90e-12\nWORKSITE_STATE_ALASKA                    -3833.826  14807.043  -0.259  0.79570\nWORKSITE_STATE_ARIZONA                    1853.808   4700.820   0.394  0.69332\nWORKSITE_STATE_ARKANSAS                  -3145.798   6705.223  -0.469  0.63896\nWORKSITE_STATE_CALIFORNIA                37350.496   4041.389   9.242  < 2e-16\nWORKSITE_STATE_COLORADO                    766.004   4916.413   0.156  0.87619\nWORKSITE_STATE_CONNECTICUT               13586.213   5267.052   2.579  0.00990\nWORKSITE_STATE_DELAWARE                   4967.846   6512.184   0.763  0.44556\nWORKSITE_STATE_DISTRICT.OF.COLUMBIA      16490.420   6710.191   2.458  0.01400\nWORKSITE_STATE_FLORIDA                  -10368.557   4178.880  -2.481  0.01310\nWORKSITE_STATE_GEORGIA                   -1299.758   4186.303  -0.310  0.75620\nWORKSITE_STATE_GUAM                     -46257.904  22149.970  -2.088  0.03678\nWORKSITE_STATE_HAWAII                     3503.894   9753.667   0.359  0.71942\nWORKSITE_STATE_IDAHO                      1079.255   8820.087   0.122  0.90261\nWORKSITE_STATE_ILLINOIS                   3129.599   4179.077   0.749  0.45394\nWORKSITE_STATE_INDIANA                  -12121.964   4928.373  -2.460  0.01392\nWORKSITE_STATE_IOWA                      -5716.220   5643.166  -1.013  0.31110\nWORKSITE_STATE_KANSAS                     4168.241   6323.517   0.659  0.50980\nWORKSITE_STATE_KENTUCKY                  -5580.384   6796.574  -0.821  0.41162\nWORKSITE_STATE_LOUISIANA                 -1687.987   5436.447  -0.310  0.75619\nWORKSITE_STATE_MAINE                      3767.002   9744.157   0.387  0.69906\nWORKSITE_STATE_MARYLAND                   7875.981   4766.622   1.652  0.09849\nWORKSITE_STATE_MASSACHUSETTS             12843.389   4301.058   2.986  0.00283\nWORKSITE_STATE_MICHIGAN                  -7748.578   4394.907  -1.763  0.07790\nWORKSITE_STATE_MINNESOTA                  -643.672   5065.010  -0.127  0.89888\nWORKSITE_STATE_MISSISSIPPI                5879.960   6893.896   0.853  0.39371\nWORKSITE_STATE_MISSOURI                  -9363.874   4693.166  -1.995  0.04603\nWORKSITE_STATE_MONTANA                   -9647.093   9386.223  -1.028  0.30406\nWORKSITE_STATE_NEBRASKA                  -6262.937   5968.008  -1.049  0.29400\nWORKSITE_STATE_NEVADA                    -6215.361   7771.300  -0.800  0.42385\nWORKSITE_STATE_NEW.HAMPSHIRE              9378.515   8166.932   1.148  0.25084\nWORKSITE_STATE_NEW.JERSEY                -1029.897   4155.496  -0.248  0.80426\nWORKSITE_STATE_NEW.MEXICO               -17893.049   9153.491  -1.955  0.05062\nWORKSITE_STATE_NEW.YORK                  25554.980   4114.762   6.211 5.39e-10\nWORKSITE_STATE_NORTH.CAROLINA             6669.708   4383.057   1.522  0.12810\nWORKSITE_STATE_NORTH.DAKOTA               6774.859   7533.602   0.899  0.36851\nWORKSITE_STATE_NORTHERN.MARIANA.ISLANDS -15150.244  37963.619  -0.399  0.68984\nWORKSITE_STATE_OHIO                      -7846.755   4277.776  -1.834  0.06662\nWORKSITE_STATE_OKLAHOMA                 -20973.675   7315.264  -2.867  0.00415\nWORKSITE_STATE_OREGON                      279.001   4952.682   0.056  0.95508\nWORKSITE_STATE_PENNSYLVANIA                 -5.127   4454.803  -0.001  0.99908\nWORKSITE_STATE_PUERTO.RICO              -13621.017  13957.159  -0.976  0.32912\nWORKSITE_STATE_RHODE.ISLAND               2327.418   7377.768   0.315  0.75241\nWORKSITE_STATE_SOUTH.CAROLINA            -8962.820   4838.642  -1.852  0.06399\nWORKSITE_STATE_SOUTH.DAKOTA              10725.947   5808.143   1.847  0.06480\nWORKSITE_STATE_TENNESSEE                   596.023   4964.502   0.120  0.90444\nWORKSITE_STATE_TEXAS                     -5219.386   4079.428  -1.279  0.20076\nWORKSITE_STATE_UTAH                       3077.229   5114.718   0.602  0.54742\nWORKSITE_STATE_VERMONT                  -27924.028  22147.716  -1.261  0.20739\nWORKSITE_STATE_VIRGINIA                   4756.554   4306.732   1.104  0.26941\nWORKSITE_STATE_WASHINGTON                32841.534   4106.077   7.998 1.33e-15\nWORKSITE_STATE_WEST.VIRGINIA             52379.028  13207.454   3.966 7.34e-05\nWORKSITE_STATE_WISCONSIN                  3823.276   4604.906   0.830  0.40640\nWORKSITE_STATE_WYOMING                   -6922.726  12051.492  -0.574  0.56568\nPW_SKILL_LEVEL_Level.II                  13336.966    849.502  15.700  < 2e-16\nPW_SKILL_LEVEL_Level.III                 23261.856   1021.926  22.763  < 2e-16\nPW_SKILL_LEVEL_Level.IV                  44772.575    827.292  54.119  < 2e-16\nPW_SKILL_LEVEL_N.A                       29260.958   1562.660  18.725  < 2e-16\nMINIMUM_EDUCATION_Bachelor.s             48194.642   3060.740  15.746  < 2e-16\nMINIMUM_EDUCATION_Doctorate              68236.481   3863.906  17.660  < 2e-16\nMINIMUM_EDUCATION_High.School           -18748.933   3257.785  -5.755 8.79e-09\nMINIMUM_EDUCATION_Master.s               53482.836   3066.619  17.440  < 2e-16\nMINIMUM_EDUCATION_None                  -14857.688   3107.090  -4.782 1.75e-06\nMINIMUM_EDUCATION_Other                 114956.363   3653.571  31.464  < 2e-16\nREQUIRED_EXPERIENCE_Y                     5742.503    599.493   9.579  < 2e-16\n                                           \n(Intercept)                             ***\nWORKSITE_STATE_ALASKA                      \nWORKSITE_STATE_ARIZONA                     \nWORKSITE_STATE_ARKANSAS                    \nWORKSITE_STATE_CALIFORNIA               ***\nWORKSITE_STATE_COLORADO                    \nWORKSITE_STATE_CONNECTICUT              ** \nWORKSITE_STATE_DELAWARE                    \nWORKSITE_STATE_DISTRICT.OF.COLUMBIA     *  \nWORKSITE_STATE_FLORIDA                  *  \nWORKSITE_STATE_GEORGIA                     \nWORKSITE_STATE_GUAM                     *  \nWORKSITE_STATE_HAWAII                      \nWORKSITE_STATE_IDAHO                       \nWORKSITE_STATE_ILLINOIS                    \nWORKSITE_STATE_INDIANA                  *  \nWORKSITE_STATE_IOWA                        \nWORKSITE_STATE_KANSAS                      \nWORKSITE_STATE_KENTUCKY                    \nWORKSITE_STATE_LOUISIANA                   \nWORKSITE_STATE_MAINE                       \nWORKSITE_STATE_MARYLAND                 .  \nWORKSITE_STATE_MASSACHUSETTS            ** \nWORKSITE_STATE_MICHIGAN                 .  \nWORKSITE_STATE_MINNESOTA                   \nWORKSITE_STATE_MISSISSIPPI                 \nWORKSITE_STATE_MISSOURI                 *  \nWORKSITE_STATE_MONTANA                     \nWORKSITE_STATE_NEBRASKA                    \nWORKSITE_STATE_NEVADA                      \nWORKSITE_STATE_NEW.HAMPSHIRE               \nWORKSITE_STATE_NEW.JERSEY                  \nWORKSITE_STATE_NEW.MEXICO               .  \nWORKSITE_STATE_NEW.YORK                 ***\nWORKSITE_STATE_NORTH.CAROLINA              \nWORKSITE_STATE_NORTH.DAKOTA                \nWORKSITE_STATE_NORTHERN.MARIANA.ISLANDS    \nWORKSITE_STATE_OHIO                     .  \nWORKSITE_STATE_OKLAHOMA                 ** \nWORKSITE_STATE_OREGON                      \nWORKSITE_STATE_PENNSYLVANIA                \nWORKSITE_STATE_PUERTO.RICO                 \nWORKSITE_STATE_RHODE.ISLAND                \nWORKSITE_STATE_SOUTH.CAROLINA           .  \nWORKSITE_STATE_SOUTH.DAKOTA             .  \nWORKSITE_STATE_TENNESSEE                   \nWORKSITE_STATE_TEXAS                       \nWORKSITE_STATE_UTAH                        \nWORKSITE_STATE_VERMONT                     \nWORKSITE_STATE_VIRGINIA                    \nWORKSITE_STATE_WASHINGTON               ***\nWORKSITE_STATE_WEST.VIRGINIA            ***\nWORKSITE_STATE_WISCONSIN                   \nWORKSITE_STATE_WYOMING                     \nPW_SKILL_LEVEL_Level.II                 ***\nPW_SKILL_LEVEL_Level.III                ***\nPW_SKILL_LEVEL_Level.IV                 ***\nPW_SKILL_LEVEL_N.A                      ***\nMINIMUM_EDUCATION_Bachelor.s            ***\nMINIMUM_EDUCATION_Doctorate             ***\nMINIMUM_EDUCATION_High.School           ***\nMINIMUM_EDUCATION_Master.s              ***\nMINIMUM_EDUCATION_None                  ***\nMINIMUM_EDUCATION_Other                 ***\nREQUIRED_EXPERIENCE_Y                   ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 37720 on 19553 degrees of freedom\n  (66 observations deleted due to missingness)\nMultiple R-squared:  0.6167,\tAdjusted R-squared:  0.6155 \nF-statistic: 491.6 on 64 and 19553 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n## Residual Analysis\n\n::: {.cell}\n\n```{.r .cell-code}\n# Predict and calculate residuals\nresiduals_df <- fitted_model %>%\n  predict(new_data = test_data) %>%\n  bind_cols(test_data) %>%\n  mutate(residuals = WAGE_OFFER_FROM - .pred)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: ! There are new levels in a factor: NA\n! There are new levels in a factor: NA\n```\n:::\n\n```{.r .cell-code}\n# Plot residuals\nggplot(residuals_df, aes(x = .pred, y = residuals)) +\n  geom_point() +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"red\") +\n  labs(x = \"Predicted\", y = \"Residuals\", title = \"Residual Plot\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 22 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](blogpost6_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n## variable analysis\n\n::: {.cell}\n\n```{.r .cell-code}\n# Extract model coefficients and sort by absolute value\nimportance <- tidy(model_fit$fit) %>%\n  filter(term != \"(Intercept)\") %>%\n  arrange(desc(abs(estimate)))\n\nprint(importance)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 64 × 5\n   term                         estimate std.error statistic   p.value\n   <chr>                           <dbl>     <dbl>     <dbl>     <dbl>\n 1 MINIMUM_EDUCATION_Other       114956.     3654.     31.5  5.08e-212\n 2 MINIMUM_EDUCATION_Doctorate    68236.     3864.     17.7  2.94e- 69\n 3 MINIMUM_EDUCATION_Master.s     53483.     3067.     17.4  1.32e- 67\n 4 WORKSITE_STATE_WEST.VIRGINIA   52379.    13207.      3.97 7.34e-  5\n 5 MINIMUM_EDUCATION_Bachelor.s   48195.     3061.     15.7  1.60e- 55\n 6 WORKSITE_STATE_GUAM           -46258.    22150.     -2.09 3.68e-  2\n 7 PW_SKILL_LEVEL_Level.IV        44773.      827.     54.1  0        \n 8 WORKSITE_STATE_CALIFORNIA      37350.     4041.      9.24 2.66e- 20\n 9 WORKSITE_STATE_WASHINGTON      32842.     4106.      8.00 1.33e- 15\n10 PW_SKILL_LEVEL_N.A             29261.     1563.     18.7  1.47e- 77\n# ℹ 54 more rows\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot diagnostic plots\nautoplot(model_fit$fit)\n```\n\n::: {.cell-output-display}\n![](blogpost6_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set up cross-validation\ncv_folds <- vfold_cv(train_data, v = 5)\n\n# Fit and evaluate the model across folds\ncv_results <- fit_resamples(\n  workflow,\n  resamples = cv_folds,\n  metrics = metric_set(rmse, rsq)\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n→ A | warning: ! There are new levels in a factor: NA\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThere were issues with some computations   A: x1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n→ B | warning: ! There are new levels in a factor: NORTHERN MARIANA ISLANDS, ! There are new levels in a factor: NA\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThere were issues with some computations   A: x1\nThere were issues with some computations   A: x1   B: x1\n\n→ C | error:   Cannot find current progress bar for `<environment: 0x7fd1a40fec98>`\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: More than one set of outcomes were used when tuning. This should never\nhappen. Review how the outcome is specified in your model.\n```\n:::\n\n```{.r .cell-code}\ncollect_metrics(cv_results)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 6\n  .metric .estimator      mean     n std_err .config             \n  <chr>   <chr>          <dbl> <int>   <dbl> <chr>               \n1 rmse    standard   35247.        1      NA Preprocessor1_Model1\n2 rsq     standard       0.647     1      NA Preprocessor1_Model1\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate and add prediction intervals to the prediction frame\ninterval_df <- predict(fitted_model, new_data = test_data, type = \"pred_int\", level = 0.95)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: ! There are new levels in a factor: NA\n! There are new levels in a factor: NA\n```\n:::\n\n```{.r .cell-code}\n# print(interval_df)\n\nprint(test_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4,921 × 18\n   CASE_NUMBER CASE_STATUS RECEIVED_DATE       DECISION_DATE       EMPLOYER_NAME\n   <chr>       <chr>       <dttm>              <dttm>              <chr>        \n 1 A-22256-20… Certified   2022-09-22 00:00:00 2023-10-02 00:00:00 Siser North …\n 2 A-22284-37… Certified   2022-11-07 00:00:00 2023-10-02 00:00:00 META PLATFOR…\n 3 A-22290-40… Certified   2022-11-04 00:00:00 2023-10-02 00:00:00 META PLATFOR…\n 4 A-22200-90… Denied      2022-07-07 00:00:00 2023-10-02 00:00:00 AMPARTS, LP  \n 5 A-22276-32… Certified   2022-11-15 00:00:00 2023-10-02 00:00:00 WAVESTONE    \n 6 A-22308-52… Certified   2022-11-18 00:00:00 2023-10-02 00:00:00 GOOGLE LLC   \n 7 A-22223-04… Certified   2022-10-24 00:00:00 2023-10-02 00:00:00 CARGILL, INC…\n 8 A-22313-54… Certified   2022-11-18 00:00:00 2023-10-02 00:00:00 CITADEL AMER…\n 9 A-22194-87… Certified   2022-07-25 00:00:00 2023-10-02 00:00:00 AILES TECHNO…\n10 A-22187-84… Certified   2022-11-21 00:00:00 2023-10-02 00:00:00 WELLS FARGO …\n# ℹ 4,911 more rows\n# ℹ 13 more variables: EMPLOYER_NUM_EMPLOYEES <dbl>,\n#   AGENT_ATTORNEY_FIRM_NAME <chr>, PW_WAGE <dbl>, PW_SKILL_LEVEL <chr>,\n#   WORKSITE_STATE <chr>, JOB_TITLE <chr>, PW_UNIT_OF_PAY <chr>,\n#   WAGE_OFFER_FROM <dbl>, WAGE_OFFER_UNIT_OF_PAY <chr>,\n#   MINIMUM_EDUCATION <chr>, REQUIRED_EXPERIENCE <chr>,\n#   COUNTRY_OF_CITIZENSHIP <chr>, CLASS_OF_ADMISSION <chr>\n```\n:::\n:::\n\n\n\n# Conclusion\nBased on the dataset, linear regression(multivariate) is not feasible in this dataset. In terms of next step,\nAs you can see at the feature space, the data might need a model that can capture nonlinear relationships. Neural network is a bit overkill but other machine learning models such as random forest, XGBOOST, and support vector machine can help explain the dataset.",
    "supporting": [
      "blogpost6_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}